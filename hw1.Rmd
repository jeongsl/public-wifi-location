---
title: "hw1_2024311155"
output: word_document
---

## 5
```{r}
library(survival)
library(KMsurv)

bmt = read.csv("C:/Users/HOME/Desktop/Sol/!연세대학원/신뢰성 및 생존 자료 분석/bmt.txt", header=T, row.names=1)
```

### (a)
```{r}
bmt.fit = survfit(Surv(t2,d3)~1, data=bmt[bmt$group==3,], conf.int=0.95)
summary(bmt.fit)
```

```{r}
#k-m estimate of the survival function
summary(bmt.fit)$surv
```
k-m estimate of the survival function은 위와 같다.

```{r}
summary(bmt.fit)$lower #confidence interval_lower
```
95% pointwise confidence intervals of the survival function의 lower bound는 위와 같다.

```{r}
summary(bmt.fit)$upper #confidence interval_upper
```
95% pointwise confidence intervals of the survival function의 upper bound는 위와 같다.


### (b)
```{r}
summary(bmt.fit)$table['median']
```
estimate of the median survival time은 183이다.

```{r}
#install.packages('boot')
library(boot)
boot_function = function(data, index) {
  sample_data = data[index, ]
  bmt_fit = survfit(Surv(t2,d3)~1, data=sample_data, conf.int=0.95)
  median_time = summary(bmt_fit)$table["median"]
  return(median_time)
}

set.seed(123)
boot_2 = boot(data=bmt[bmt$group==3,], statistic=boot_function, R=1000)
boot.ci(boot_2, type = 'perc')$percent[4:5] #95% confidence interval of the median survival time
```
bootstrap sampling을 1000번 반복하여 95% confidence interval of the median survival time을 구하였다. 
95% confidence interval of the median survival time은 [115, 422]이다.